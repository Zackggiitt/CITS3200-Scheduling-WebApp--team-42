<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login</title>

    <!-- CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='login.css') }}">
    <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet">
</head>

<body>
    <div class="wrapper">
        <!-- Role Toggle Section -->
        <div class="role-toggle">
            <div class="toggle-container">
                <span class="toggle-label" id="facilitator-label">Facilitator</span>
                <div class="toggle-switch">
                    <input type="checkbox" id="role-toggle" class="toggle-input">
                    <label for="role-toggle" class="toggle-slider"></label>
                </div>
                <span class="toggle-label" id="admin-label">Admin</span>
            </div>
        </div>

        <form action="{{ url_for('login') }}" method="POST" id="login-form">
            <h1 id="login-title">Facilitator Login</h1>

            <!-- Hidden field to track user role -->
            <input type="hidden" name="user_role" id="user-role" value="facilitator">

            <!-- Flash messages -->
            {% with messages = get_flashed_messages() %}
              {% if messages %}
                <div class="flash-messages">
                  {% for message in messages %}
                    <p>{{ message }}</p>
                  {% endfor %}
                </div>
              {% endif %}
            {% endwith %}

            <div class="input-box">
                <i class='bx bxs-user'></i>
                <input type="text" name="email" placeholder="Email" required>
            </div>

            <div class="input-box">
                <i class='bx bxs-lock-alt'></i>
                <input type="password" name="password" placeholder="Password" required>
            </div>

            <div class="remember-forgot">
                <label><input type="checkbox"> Remember me</label>
                <a href="#">Forgot password?</a>
            </div>

            <button type="submit" class="btn" id="login-btn">Login as Facilitator</button>

            <!-- OAuth login buttons -->
            <div class="oauth-section">
                <div class="divider">
                    <span>Or sign in with</span>
                </div>
                
                <div class="oauth-buttons">
                    <a href="{{ url_for('google_login') }}" class="oauth-btn google-btn">
                        <i class='bx bxl-google'></i>
                        Sign in with Google
                    </a>
                </div>
            </div>

            <div class="register-link">
                <p>Don't have an account? <a href="{{ url_for('signup') }}">Register</a></p>
            </div>
        </form>
    </div>

    <script>
        const roleToggle = document.getElementById('role-toggle');
        const loginTitle = document.getElementById('login-title');
        const loginBtn = document.getElementById('login-btn');
        const userRoleInput = document.getElementById('user-role');
        const facilitatorLabel = document.getElementById('facilitator-label');
        const adminLabel = document.getElementById('admin-label');

        roleToggle.addEventListener('change', function() {
            if (this.checked) {
                // Admin mode
                loginTitle.textContent = 'Admin Login';
                loginBtn.textContent = 'Login as Admin';
                userRoleInput.value = 'admin';
                facilitatorLabel.classList.remove('active');
                adminLabel.classList.add('active');
            } else {
                // Facilitator mode
                loginTitle.textContent = 'Facilitator Login';
                loginBtn.textContent = 'Login as Facilitator';
                userRoleInput.value = 'facilitator';
                facilitatorLabel.classList.add('active');
                adminLabel.classList.remove('active');
            }
        });

        // Initialize facilitator as active
        facilitatorLabel.classList.add('active');
    </script>
</body>

</html>
